drop database integrationweb;
Create database integrationweb;

use integrationweb;

Create table cours (
id int auto_increment,
libelle varchar(256) not null, 
primary key (id) 
)
ENGINE=InnoDB;

Create table pageDeGarde (
id int auto_increment,
dateInjection timestamp not null default current_timestamp,
emplacement varchar(256) not null,
libellePdg varchar(256) not null,
derniereModification timestamp not null default current_timestamp on update current_timestamp, 
numVersion int default 1, 
primary key (id)
)
ENGINE=InnoDB;


Create table supportCoursGen ( 
id int auto_increment, 
dateGeneration timestamp not null default current_timestamp,
emplacement varchar(256) not null, 
derniereModification timestamp not null default current_timestamp on update current_timestamp,  
numVersion int default 1,
libelle varchar(256) not null, 
idSupportCoursSource int, 
idCodeBaps int not null, 
primary key (id)
)
ENGINE=InnoDB;

create table pdgLier ( 
idPageDeGarde int, 
idSupportCoursGen int,  
primary key(idPageDeGarde, idSupportCoursGen)
)
ENGINE=InnoDB;


create table codeBaps ( 
id int auto_increment, 
libCodeBaps varchar(256) not null, 
idCours int, 
primary key (id)
) 
ENGINE=InnoDB;

create table sourceSlide ( 
id int auto_increment, 
dateInjection timestamp not null default current_timestamp,
emplacement varchar(256) not null, 
dateDerniereModification timestamp not null default current_timestamp on update current_timestamp, 
libelle varchar(256) not null,
numVersion int default 1,
idSupportCours int, 
idCodeBaps int not null, 
primary key (id)
)
ENGINE=InnoDB;

create table supportCoursSource (
id int auto_increment, 
dateInjection timestamp not null default current_timestamp,
emplacement varchar(256) not null,
derniereModification timestamp not null default current_timestamp on update current_timestamp,  
numVersion int default 1, 
libellePdf varchar(256) not null, 
idCours int not null, 
idCodeBaps int not null, 
idSlide int, 
primary key (id) 
) 
ENGINE=InnoDB;


ALTER TABLE supportCoursGen 
ADD CONSTRAINT fk_supportCoursGen_supCoursSource FOREIGN KEY (idSupportCoursSource)
REFERENCES supportCoursSource(id);

ALTER TABLE supportCoursGen
ADD CONSTRAINT fk_supportCoursGen_libCodeBaps FOREIGN KEY (idCodeBaps) REFERENCES codeBaps (id); 

foreign key (idSupportCoursSource) references supportCoursSource(id),
foreign key (codeBaps) references codeBaps(codeBaps)



alter table pdgLier 
add constraint fk_pdgLier_idPageDeGarde foreign key (idPageDeGarde) references pageDeGarde(id);

alter table pdgLier
add constraint fk_pdgLier_idSupportCoursGen foreign key (idSupportCoursGen) references supportCoursGen(id);

foreign key (idPageDeGarde) references pageDeGarde(id), 
foreign key (idSupportCoursGen) references supportCoursGen(id) 



alter table codeBaps 
add constraint fk_codeBaps_idCours foreign key (idCours) references cours(id);

foreign key (idCours) references cours(id)


alter table sourceSlide 
add constraint fk_sourceSlide_idSupportCours foreign key (idSupportCours) references supportCoursSource(id);

alter table sourceSlide
add constraint fk_sourceSlide_idCodeBaps foreign key (idCodeBaps) references codeBaps(id);

foreign key (idSupportCours) references supportCoursSource(id), 
foreign key (codeBaps) references codeBaps (codeBaps)

alter table supportCoursSource
add constraint fk_supportCoursSource_codeBaps foreign key (idCodeBaps) references codeBaps(id);

alter table supportCoursSource 
add constraint fk_supportCoursSource_idSlide foreign key (idSlide) references sourceSlide(id);

alter table supportCoursSource 
add constraint fk_supportCoursSource_idCours foreign key (idCours) references cours(id);

foreign key (codeBaps) references codeBaps (codeBaps), 
foreign key (idSlide) references sourceSlide (id)










  



