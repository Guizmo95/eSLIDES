drop database integrationweb;
Create database integrationweb;

use integrationweb;

Create table cours (
id int auto_increment,
libelle varchar(256) not null unique, 
codeBaps varchar(256),
primary key (id) 
)
ENGINE=InnoDB;

create table codeBaps ( 
id int auto_increment, 
libelleCodeBaps varchar(256) not null unique, 
libelleCours varchar(256), 
codeRayhane varchar(256),
primary key (id)
) 
ENGINE=InnoDB;

create table codeRayhane (
id int auto_increment,
codeRayhane varchar(256) not null unique,
codeBaps varchar(256),
primary key (id)
)
ENGINE = INNODB;

Create table stockerPageDeGarde (
id int auto_increment, 
emplacement varchar(256) not null, 
libelle varchar(256) not null unique, 
dateInjection timestamp not null default current_timestamp,
derniereModification timestamp not null default current_timestamp on update current_timestamp, 
primary key(id)
) 
ENGINE = InnoDb;


Create table supportCoursGen ( 
id int auto_increment, 
dateGeneration timestamp not null default current_timestamp,
emplacement varchar(256) not null, 
derniereModification timestamp not null default current_timestamp on update current_timestamp,  
libelle varchar(256) not null unique, 
idSupportCoursSource int, 
idSlide int,
codeBaps varchar(256),
codeRayhane varchar(256),
primary key (id)
)
ENGINE=InnoDB;

create table supportCoursSource (
id int auto_increment, 
dateInjection timestamp not null default current_timestamp,
emplacement varchar(256) not null,
derniereModification timestamp not null default current_timestamp on update current_timestamp,  
libelle varchar(256) not null, 
codeBaps varchar(256),
codeRayhane varchar(256), 
idSlide int, 
idSupportCoursGen int, 
primary key (id) 
) 
ENGINE=InnoDB;

create table slide ( 
id int auto_increment, 
dateInjection timestamp not null default current_timestamp,
emplacement varchar(256) not null, 
dateDerniereModification timestamp not null default current_timestamp on update current_timestamp, 
libelle varchar(256) not null,
idSupportCoursSource int, 
idSupportCoursGen int, 
codeBaps varchar(256),
codeRayhane varchar(256), 
primary key (id)
)
ENGINE=InnoDB;





alter table cours 
add constraint fk_cours_codeBaps foreign key(codeBaps) references codeBaps(libelleCodeBaps);




alter table codeBaps 
add constraint fk_codeBaps_cours foreign key(libelleCours) references cours(libelle);

alter table codeBaps 
add constraint fk_codeBaps_codeRayhane foreign key(codeRayhane) references codeRayhane(codeRayhane);





alter table codeRayhane 
add constraint fk_codeRayhane_codeBaps foreign key(codeBaps) references codeBaps(libelleCodeBaps);




ALTER TABLE supportCoursGen 
ADD CONSTRAINT fk_supportCoursGen_supCoursSource FOREIGN KEY (idSupportCoursSource)
REFERENCES supportCoursSource(id);

ALTER TABLE supportCoursGen
ADD CONSTRAINT fk_supportCoursGen_codeBaps FOREIGN KEY (codeBaps) REFERENCES codeBaps (libelleCodeBaps); 

ALTER TABLE supportCoursGen
ADD CONSTRAINT fk_supportCoursGen_codeRayhane FOREIGN KEY (codeRayhane) REFERENCES codeRayhane (codeRayhane); 


ALTER TABLE supportCoursGen
ADD CONSTRAINT fk_supportCoursGen_idSlide FOREIGN KEY (idSlide) REFERENCES slide (id); 




ALTER TABLE supportCoursSource 
ADD CONSTRAINT fk_supportCoursSource_supCoursGen FOREIGN KEY (idSupportCoursGen)
REFERENCES supportCoursGen(id);

ALTER TABLE supportCoursSource
ADD CONSTRAINT fk_supportCoursSource_codeBaps FOREIGN KEY (codeBaps) REFERENCES codeBaps (libelleCodeBaps); 

ALTER TABLE supportCoursSource
ADD CONSTRAINT fk_supportCoursSource_codeRayhane FOREIGN KEY (codeRayhane) REFERENCES codeRayhane (codeRayhane); 

ALTER TABLE supportCoursSource
ADD CONSTRAINT fk_supportCoursSource_idSlide FOREIGN KEY (idSlide) REFERENCES slide (id); 




alter table slide 
add constraint fk_slide_idSupportCoursSource foreign key (idSupportCoursSource) references supportCoursSource(id);

alter table slide 
add constraint fk_slide_idSupportCoursGen foreign key (idSupportCoursGen) references supportCoursGen(id);


alter table slide
add constraint fk_sourceSlide_codeBaps foreign key (codeBaps) references codeBaps(libelleCodeBaps);

alter table slide
add constraint fk_sourceSlide_codeRayhane foreign key (codeRayhane) references codeRayhane(codeRayhane);











  



